# Factory

## 概要

エアドロップテンプレートを管理しエアドロップをデプロイする

エアドロップ主催者がエアドロップを開始するためのエントリーポイントになる

## 共通仕様

### エアドロップテンプレート

- bytes32（utf8 を変換したもの）に対応するアドレスで管理される
- 上書きはできない

### エアドロップテンプレートの追加

- オーナーのみ可能
- 引数
  - templateName\_
    - bytes32
    - エアドロップテンプレートの名前
  - templateAddr\_
    - address
    - エアドロップテンプレートのアドレス
  - initializeSignature\_
    - bytes4
    - エアドロップ初期化用関数シグネチャ
  - transferSignature\_
    - bytes4
    - エアドロップ初期化時トークン転送用関数シグネチャ

### エアドロップテンプレートの削除

- オーナーのみ可能
- 引数
  - templateName\_
    - bytes32
    - エアドロップテンプレートの名前

### エアドロップの設置

- 引数
  - templateName\_
    - bytes32
    - エアドロップテンプレートの名前
  - nonce\_
    - bytes32
    - オフチェーンデータと紐づく UUID を想定
  - args\_
    - bytes
    - エアドロップテンプレート初期化に必要な引数の集合

##### 処理概要

- テンプレートを minimal proxy パターンでデプロイする
- テンプレートアドレスとナンスを salt にした CREATE2 によってインスタンスアドレスが決まる
- 初期化関数はテンプレートごとのシグネチャ＋引数の call で実行する
- デプロイ時に販売トークンをエアドロップに転送する
- 転送関数はテンプレートごとのシグネチャ＋引数の delegatecall で実行する
- デプロイしたエアドロップのアドレスを記録する

### エアドロップ保持

- デプロイしたエアドロップを mapping(address->bool)にて保持する
